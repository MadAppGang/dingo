---
// VS Code-style code block with macOS window controls
// Reference: reference/src/components/CodeComparison.tsx
import { codeToHtml } from 'shiki';
import { dingoLanguage } from '../lib/dingoLanguage';

interface Props {
  code: string;
  language: string;
  label?: string;
  title?: string;
}

const { code, language } = Astro.props;

// Generate syntax-highlighted HTML using Shiki with VS Code Dark Plus theme
const langInput = language === 'dingo' ? dingoLanguage : language;
const highlightedCode = await codeToHtml(code, {
  // Cast required because shiki's bundled types only accept built-in languages.
  lang: langInput as any,
  theme: 'dark-plus',
});
---

<div class="bg-[#1e1e1e] rounded-xl overflow-hidden shadow-2xl">
  <!-- macOS-style window controls -->
  <div class="bg-[#323232] px-4 py-3 flex items-center gap-2">
    <div class="w-3 h-3 rounded-full bg-[#ff5f56]"></div>
    <div class="w-3 h-3 rounded-full bg-[#ffbd2e]"></div>
    <div class="w-3 h-3 rounded-full bg-[#27c93f]"></div>
  </div>

  <!-- Code content -->
  <div class="overflow-auto">
    <div class="code-wrapper" set:html={highlightedCode} />
  </div>
</div>

<style>
  .code-wrapper :global(pre) {
    margin: 0;
    padding: 24px;
    background: #1e1e1e;
    font-size: 14px;
    line-height: 1.6;
  }

  .code-wrapper :global(code) {
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  }
</style>
