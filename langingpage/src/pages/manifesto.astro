---
import '../styles/tailwind-v4.css';
import { readFileSync } from 'node:fs';
import { join } from 'node:path';
import { marked } from 'marked';

// Read the manifesto from parent directory
const manifestoPath = join(process.cwd(), '..', 'MANIFESTO.md');
const manifestoContent = readFileSync(manifestoPath, 'utf-8');

// Configure marked for better rendering
marked.setOptions({
  gfm: true, // GitHub Flavored Markdown
  breaks: false,
  headerIds: true,
  mangle: false,
});

// Convert markdown to HTML
const manifestoHtml = marked.parse(manifestoContent);
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Dingo Manifesto - Go Broke Free</title>
  <meta name="description" content="The Dingo Manifesto: A community-driven meta-language for Go with Result types, pattern matching, and developer freedom" />
  <meta property="og:title" content="The Dingo Manifesto - Go Broke Free" />
  <meta property="og:description" content="Power to the people, not the committee. Build Go your way." />
  <meta property="og:type" content="article" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
</head>
<body class="bg-gray-50">
  <!-- Navigation -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-10">
    <div class="max-w-4xl mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <a href="/" class="text-blue-600 hover:text-blue-700 text-sm font-medium transition-colors">
          ← Back to Examples
        </a>
        <h1 class="text-gray-900 text-lg font-semibold">The Dingo Manifesto</h1>
        <a
          href="https://github.com/MadAppGang/dingo"
          target="_blank"
          rel="noopener noreferrer"
          class="text-gray-600 hover:text-gray-900 text-sm font-medium transition-colors"
        >
          GitHub →
        </a>
      </div>
    </div>
  </nav>

  <!-- Manifesto Content -->
  <main class="max-w-4xl mx-auto px-6 py-12">
    <article class="bg-white rounded-lg shadow-sm p-8 md:p-12">
      <!-- Rendered markdown content -->
      <div class="manifesto-content" set:html={manifestoHtml} />
    </article>

    <!-- Call to Action -->
    <div class="mt-12 text-center">
      <div class="inline-flex flex-col sm:flex-row gap-4">
        <a
          href="https://github.com/MadAppGang/dingo"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"
        >
          Star on GitHub
        </a>
        <a
          href="/"
          class="inline-flex items-center justify-center px-6 py-3 bg-white text-gray-700 font-medium rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors"
        >
          Explore Examples
        </a>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="max-w-4xl mx-auto px-6 py-12 text-center text-gray-600 text-sm">
    <p>Built by developers who love Go but believe in freedom.</p>
    <p class="mt-2 italic">Go that escaped.</p>
  </footer>
</body>
</html>

<style is:global>
  /* Typography styles for manifesto content */
  .manifesto-content {
    line-height: 1.75;
    font-size: 1.0625rem;
    color: #374151;
  }

  /* Headers - with proper hierarchy and spacing */
  .manifesto-content h1 {
    font-size: 2.5rem !important;
    font-weight: 800 !important;
    color: #111827 !important;
    margin-bottom: 1.5rem !important;
    margin-top: 2.5rem !important;
    line-height: 1.2 !important;
    letter-spacing: -0.025em !important;
  }

  .manifesto-content h1:first-child {
    margin-top: 0 !important;
  }

  .manifesto-content h2 {
    font-size: 2rem !important;
    font-weight: 700 !important;
    color: #111827 !important;
    margin-bottom: 1.25rem !important;
    margin-top: 3rem !important;
    line-height: 1.3 !important;
    letter-spacing: -0.025em !important;
    border-bottom: 2px solid #e5e7eb;
    padding-bottom: 0.5rem !important;
  }

  .manifesto-content h3 {
    font-size: 1.5rem !important;
    font-weight: 600 !important;
    color: #1f2937 !important;
    margin-bottom: 1rem !important;
    margin-top: 2rem !important;
    line-height: 1.4 !important;
  }

  .manifesto-content h4 {
    font-size: 1.25rem !important;
    font-weight: 600 !important;
    color: #1f2937 !important;
    margin-bottom: 0.75rem !important;
    margin-top: 1.5rem !important;
    line-height: 1.5 !important;
  }

  /* Paragraphs */
  .manifesto-content p {
    color: #374151 !important;
    line-height: 1.8 !important;
    margin-bottom: 1.25rem !important;
    font-size: 1.0625rem !important;
  }

  /* Blockquotes - styled beautifully */
  .manifesto-content blockquote {
    border-left: 4px solid #3b82f6 !important;
    padding-left: 1.25rem !important;
    padding-right: 1rem !important;
    padding-top: 0.5rem !important;
    padding-bottom: 0.5rem !important;
    font-style: italic !important;
    color: #4b5563 !important;
    margin: 1.5rem 0 !important;
    background-color: #f9fafb !important;
    border-radius: 0.25rem !important;
  }

  .manifesto-content blockquote p {
    margin-bottom: 0.5rem !important;
  }

  .manifesto-content blockquote p:last-child {
    margin-bottom: 0 !important;
  }

  /* Text styling */
  .manifesto-content strong {
    font-weight: 700 !important;
    color: #111827 !important;
  }

  .manifesto-content em {
    font-style: italic !important;
  }

  /* Inline code */
  .manifesto-content code {
    background-color: #f3f4f6 !important;
    color: #e11d48 !important;
    padding: 0.125rem 0.375rem !important;
    border-radius: 0.25rem !important;
    font-size: 0.9em !important;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
    font-weight: 500 !important;
  }

  /* Code blocks */
  .manifesto-content pre {
    background-color: #1e293b !important;
    color: #e2e8f0 !important;
    padding: 1.25rem !important;
    border-radius: 0.5rem !important;
    overflow-x: auto !important;
    margin: 1.5rem 0 !important;
    line-height: 1.7 !important;
    border: 1px solid #334155 !important;
  }

  .manifesto-content pre code {
    background-color: transparent !important;
    color: #e2e8f0 !important;
    padding: 0 !important;
    border-radius: 0 !important;
    font-size: 0.9375rem !important;
  }

  /* Links */
  .manifesto-content a {
    color: #2563eb !important;
    text-decoration: underline !important;
    text-underline-offset: 2px !important;
    transition: color 0.15s ease !important;
  }

  .manifesto-content a:hover {
    color: #1d4ed8 !important;
  }

  /* Lists - force display with !important to override Tailwind reset */
  .manifesto-content ul {
    list-style-type: disc !important;
    margin-left: 2rem !important;
    margin-top: 1rem !important;
    margin-bottom: 1rem !important;
    padding-left: 0 !important;
    color: #374151 !important;
  }

  .manifesto-content ol {
    list-style-type: decimal !important;
    margin-left: 2rem !important;
    margin-top: 1rem !important;
    margin-bottom: 1rem !important;
    padding-left: 0 !important;
    color: #374151 !important;
  }

  .manifesto-content li {
    margin-bottom: 0.5rem !important;
    line-height: 1.7 !important;
    padding-left: 0.5rem !important;
  }

  .manifesto-content ul ul,
  .manifesto-content ol ul {
    margin-top: 0.5rem !important;
    margin-bottom: 0.5rem !important;
  }

  .manifesto-content ul ol,
  .manifesto-content ol ol {
    margin-top: 0.5rem !important;
    margin-bottom: 0.5rem !important;
  }

  /* Horizontal rule */
  .manifesto-content hr {
    margin-top: 3rem !important;
    margin-bottom: 3rem !important;
    border: 0 !important;
    border-top: 2px solid #e5e7eb !important;
  }

  /* Tables */
  .manifesto-content table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 2rem 0 !important;
    font-size: 0.9375rem !important;
    overflow: hidden !important;
    border-radius: 0.5rem !important;
    border: 1px solid #d1d5db !important;
  }

  .manifesto-content thead {
    background-color: #f9fafb !important;
  }

  .manifesto-content th {
    border: 1px solid #d1d5db !important;
    padding: 0.75rem 1rem !important;
    text-align: left !important;
    font-weight: 600 !important;
    color: #111827 !important;
  }

  .manifesto-content td {
    border: 1px solid #d1d5db !important;
    padding: 0.75rem 1rem !important;
    color: #374151 !important;
  }

  .manifesto-content tbody tr:nth-child(even) {
    background-color: #f9fafb !important;
  }

  .manifesto-content tbody tr:hover {
    background-color: #f3f4f6 !important;
  }

  /* Footnote references */
  .manifesto-content sup {
    font-size: 0.75em !important;
    line-height: 0 !important;
  }

  /* Responsive typography */
  @media (max-width: 768px) {
    .manifesto-content {
      font-size: 1rem;
    }

    .manifesto-content h1 {
      font-size: 2rem !important;
    }

    .manifesto-content h2 {
      font-size: 1.625rem !important;
    }

    .manifesto-content h3 {
      font-size: 1.375rem !important;
    }

    .manifesto-content h4 {
      font-size: 1.125rem !important;
    }

    .manifesto-content ul,
    .manifesto-content ol {
      margin-left: 1.5rem !important;
    }

    .manifesto-content table {
      font-size: 0.875rem !important;
    }

    .manifesto-content th,
    .manifesto-content td {
      padding: 0.5rem 0.75rem !important;
    }
  }

  @media (max-width: 640px) {
    .manifesto-content h1 {
      font-size: 1.75rem !important;
    }

    .manifesto-content h2 {
      font-size: 1.5rem !important;
    }
  }
</style>
